<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="notice">

  <select id="totalCount" resultType="int">
    SELECT COUNT(*) FROM notice_table;
  </select>

  <select id="list" resultType="mybatis.vo.NoticeVO" parameterType="Map">
    SELECT * FROM (
    SELECT @RN := @RN + 1 AS rnum, a.*
    FROM (
    SELECT * FROM notice_table
    ORDER BY idx
    ) a, (SELECT @RN := 0) b
    ) c
    WHERE c.rnum BETWEEN #{begin} AND #{end}
  </select>

  <select id="selectOne" resultType="mybatis.vo.NoticeVO" parameterType="String">
    SELECT * FROM notice_table WHERE idx = #{idx}
  </select>

  <update id="updateNotice" parameterType="mybatis.vo.NoticeVO">
    UPDATE notice_table SET title = #{title}, content = #{content}, update_date = NOW() WHERE idx = #{idx}
  </update>

  <insert id="insertNotice" parameterType="mybatis.vo.NoticeVO">
    INSERT INTO notice_table (title, content, reg_date, update_date, hit, status)
    VALUES (#{title}, #{content}, NOW(), NOW(), 0, 0)
  </insert>

  <update id="deleteNotice" parameterType="String">
    UPDATE notice_table SET status = 1, update_date = NOW() WHERE idx = #{idx}
  </update>

  <update id="restoreNotice" parameterType="String">
    UPDATE notice_table SET status = 0, update_date = NOW() WHERE idx = #{idx}
  </update>

</mapper>